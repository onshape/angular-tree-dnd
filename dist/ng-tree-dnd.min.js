/**
 * The MIT License (MIT)
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 */
/**
 * Implementing TreeDnD & Event DrapnDrop (allow drag multi tree-table include all type: table, ol, ul)
 * Demo: http://thienhung1989.github.io/angular-tree-dnd
 * Github: https://github.com/thienhung1989/angular-tree-dnd
 * @version 3.0.6
 * (c) 2015 Nguyuễn Thiện Hùng - <nguyenthienhung1989@gmail.com>
 */
!function(){"use strict";function e(e,n,t,a,r,l,o,d,i,_,s,c){function u(n,t,a){function c(){n.treeData=K,b(),H=null}function u(e,n,t){return angular.isUndefinedOrNull(n)?!1:"*"!==n&&angular.isUndefined(e[n])?angular.isArray(n)?g(e,n,t):void 0:!0}function g(e,n,t){var a,r=n.length,l=!1;if(0===r)return null;for(a=0;r>a;a++)if(u(e,n[a],!t)){if(l=!0,!t)return!0}else if(t)return!1;return l}function f(e,t,r,l,o,d,i){if(l=l||t,"string"==typeof e||angular.isArray(e)){if(angular.isFunction(i)&&i())return;"string"==typeof a[t]?n.$watch(a[t],function(t){"string"==typeof e&&typeof t===e||angular.isArray(e)&&e.indexOf(typeof t)>-1?n[l]=t:angular.isFunction(r)?n[l]=r(t):n[l]=r,angular.isFunction(d)&&d(n[l],n)},!0):angular.isFunction(o)?n[l]=o():angular.isUndefined(o)||(n[l]=o)}}function p(e){var n=this.$root.$$phase;"$apply"===n||"$digest"===n?e&&"function"==typeof e&&e():this.$apply(e)}function h(){if(n.treeData&&n.treeData.length){var e,t,a=n.treeData[0],r=Object.keys(a),l=new RegExp("^__([a-zA-Z0-9_-]*)__$");for(t=0,e=r.length;e>t;t++)if("string"==typeof a[r[t]]&&!l.test(r[t]))return void(n.expandingProperty=r[t]);angular.isUndefinedOrNull(n.expandingProperty)&&(n.expandingProperty=r[0])}}function m(){if(n.treeData.length){var e,t,a=[],r=n.treeData[0],l=new RegExp("(^__([a-zA-Z0-9_-]*)__$|^"+n.expandingProperty+"$)"),o=Object.keys(r);for(e=0,t=o.length;t>e;e++)"string"!=typeof r[o[e]]||l.test(o[e])||a.push({field:o[e]});n.colDefinitions=a}}function v(e,t,a,r,l,o,d){var i,_,s,c,u,g;if(angular.isArray(t.__children__)||(t.__children__=[]),t.__parent_real__=r,t.__parent__=a,_=t.__children__.length,angular.isUndefinedOrNull(t.__expanded__)&&_>0&&(t.__expanded__=l<n.expandLevel),s=0===_?-1:t.__expanded__?1:0,c=e.length,t.__index__=d,t.__index_real__=c,t.__level__=l,t.__icon__=s,t.__icon_class__=n.$class.icon[s],t.__visible__=!!o,angular.isUndefinedOrNull(t.__uid__)&&(t.__uid__=""+Math.random()),g=n.getHash(t),(angular.isUndefinedOrNull(t.__hashKey__)||t.__hashKey__!==g)&&(t.__hashKey__=g),e.push(t),u=1,_>0)for(i=0;_>i;i++)u+=v(e,t.__children__[i],t[n.primary_key],c,l+1,o&&t.__expanded__,i);return t.__dept__=u,u}function $(e){return angular.isDefined(n.tree_nodes)&&delete n.tree_nodes,n.tree_nodes=e,e}function b(e){var t,r,l=[];if(angular.isDefined(e)){if(!angular.isArray(e)||0===e.length)return $([]);t=e}else{if(!angular.isArray(n.treeData)||0===n.treeData.length)return $([]);t=n.treeData}if(a.expandOn||h(),a.columnDefs||m(),angular.isDefined(n.orderBy)&&(angular.isFunction(T)||(T=s("$TreeDnDOrderBy")),angular.isFunction(T)&&(t=T(t,n.orderBy))),angular.isDefined(n.filter)&&(angular.isFunction(w)||(w=s("$TreeDnDFilter")),angular.isFunction(w)&&(t=w(t,n.filter,n.filterOptions))),r=t.length,r>0){var o,d=0;for(o=0;r>o;o++)d+=v(l,t[o],null,null,1,!0,o)}return $(l),l}n.indent=20,n.indent_plus=15,n.indent_unit="px",n.$tree_class="table",n.primary_key="__uid__",n.$type="TreeDnD",n.colDefinitions=[],n.$globals={},n.$class={},n.treeData=[],n.tree_nodes=[],n.$class=angular.copy(i),angular.extend(n.$class.icon,{1:a.iconExpand||"fa fa-fw fa-chevron-down",0:a.iconCollapse||"fa fa-fw fa-chevron-right","-1":a.iconLeaf||"fa fa-fw"}),n.for_all_descendants=function(e,t,a,r){if(angular.isFunction(t)){var l,o,d;if(t(e,a))return!1;for(d=e.__children__,o=d?d.length:0,l=0;o>l;l++)if(!n.for_all_descendants(d[l],t,e)&&!r)return!1}return!0},n.getLastDescendant=function(e){var t,a;return e||(e=n.tree?n.tree.anchor_node:!1),e===!1?!1:(a=e.__children__.length,0===a?e:(t=e.__children__[a-1],n.getLastDescendant(t)))},n.getElementChilds=function(){return angular.element(t[0].querySelector("[tree-dnd-nodes]"))},n.onClick=function(e,t){angular.isDefined(n.tree)&&(t.metaKey||t.shiftKey||n.tree.select_anchor_node(e),angular.isFunction(n.tree.on_click)&&setTimeout(function(){n.tree.on_click(e)},0))},n.onSelect=function(e,t){angular.isDefined(n.tree)&&(t.metaKey?n.tree.add_select_node(e):t.shiftKey?n.tree.range_select_node(e):e.__selected__||n.tree.select_anchor_node(e),angular.isFunction(n.tree.on_select)&&setTimeout(function(){n.tree.on_select(e)},0))};var y,D;n.toggleExpand=function(e,t){y=!0,angular.isFunction(t)&&!t(e)?y=!1:angular.isFunction(n.$callbacks.expand)&&!n.$callbacks.expand(e)&&(y=!1),y&&e.__children__.length>0&&(e.__expanded__=!e.__expanded__)};var x=function(e){return"#"+e.__parent__+"#"+e[n.primary_key]},E=function(e){var n=x(e);return(angular.isUndefinedOrNull(e.__hashKey__)||e.__hashKey__!==n)&&(e.__hashKey__=n),e};n.getHash=x,n.$callbacks={getHash:x,setHash:E,for_all_descendants:n.for_all_descendants,accept:function(e,t,a){return n.dropEnabled===!0},calsIndent:function(e,t,a){var r=0,l=a?0:n.indent_plus;return t||(r=n.indent_unit?n.indent_unit:"px"),1>e-1?l+r:n.indent*(e-1)+l+r},droppable:function(){return n.dropEnabled===!0},draggable:function(){return n.dragEnabled===!0},beforeDrop:function(e){return!0},changeKey:function(e){var t=e.__uid__;e.__uid__=Math.random(),e.__selected__&&delete e.__selected__,"__uid__"!==n.primary_key&&(t=""+e[n.primary_key],t=t.replace(/_#.+$/g,"")+"_#"+e.__uid__,e[n.primary_key]=t)},clone:function(e,n){return D=angular.copy(e),this.for_all_descendants(D,this.changeKey),D},remove:function(e,t,a,r){var l=t.splice(e.__index__,1)[0];return r||n.reload_data(),l},clearInfo:function(e){delete e.__inited__,delete e.__visible__},add:function(e,n,t,a){this.for_all_descendants(e,this.clearInfo),t&&(t.length>-1&&n>-1?t.splice(n,0,e):t.push(e))}},n.deleteScope=function(e,t){var a=t.__hashKey__;n.$globals[a]&&n.$globals[a]===e&&delete n.$globals[a]},n.setScope=function(e,t){var a=t.__hashKey__;n.$globals[a]!==e&&(n.$globals[a]=e)},n.getScope=function(e){if(e){var t=e.__hashKey__;return n.$globals[t]}return n},(a.enableDrag||a.enableDrop)&&(n.placeElm=null,n.dragEnabled=null,n.dropEnabled=null,n.horizontal=null,a.enableDrag&&(n.dragDelay=0,n.enabledMove=!0,n.statusMove=!0,n.enabledHotkey=!1,n.enabledCollapse=null,n.statusElm=null,n.dragging=null,angular.extend(n.$callbacks,{beforeDrag:function(e){return!0},dragStop:function(e,n){return!e||!e.changed&&e.drag.enabledMove||!n?null:(e.target.reload_data(),void(e.target!==e.drag&&e.drag.enabledMove&&e.drag.reload_data()))},dropped:function(e,n,t){if(!e)return null;if(!e.changed&&t)return!1;var a=e.node,r=e.nodes,l=e.drag.tree,o=null,d=e.move,i=d.parent;if(e.target.$callbacks.accept(e,e.move,e.changed)){t?l.remove_nodes(r,!0):o=e.drag.$callbacks.clone(a,e.drag.$callbacks);var _=d.pos;return e.drag===e.target&&r.forEach(function(e){var n=l.get_parent(e)===d.parent,t=e.__index__<_;n&&t&&d.pos--}),l.add_nodes(i,r,d.pos),!0}return!1},dragStart:function(e){},dragMove:function(e){}}),n.setDragging=function(e){n.dragging=e},n.enableMove=function(e){"boolean"==typeof e?n.enabledMove=e:n.enabledMove=!0},a.enableStatus&&(n.enabledStatus=!1,n.hideStatus=function(){n.statusElm&&n.statusElm.addClass(n.$class.hidden)},n.refreshStatus=function(){if(n.dragging&&n.enabledStatus){var e=n.statusElm;n.enabledMove?n.statusElm=angular.element(d.getMove(n)):n.statusElm=angular.element(d.getCopy(n)),e!==n.statusElm&&(e&&(n.statusElm.attr("class",e.attr("class")),n.statusElm.attr("style",e.attr("style")),e.remove()),l.find("body").append(n.statusElm)),n.statusElm.removeClass(n.$class.hidden)}},n.setPositionStatus=function(e){n.statusElm&&(n.statusElm.css({left:e.pageX+10+"px",top:e.pageY+15+"px","z-index":9999}),n.statusElm.addClass(n.$class.status))})),n.targeting=!1,n.getPrevSibling=function(e){if(e&&e.__index__>0){var t,a=e.__index__-1;return angular.isDefined(e.__parent_real__)?(t=n.tree_nodes[e.__parent_real__],t.__children__[a]):n.treeData[a]}return null},n.getNode=function(e){return angular.isUndefinedOrNull(e)?null:n.tree_nodes[e]},n.initPlace=function(e,t){if(!n.placeElm)if(n.isTable){n.placeElm=angular.element(r.document.createElement("tr"));var a=n.colDefinitions.length;for(n.placeElm.append(angular.element(r.document.createElement("td")).addClass(n.$class.empty).addClass("indented").addClass(n.$class.place));a-- >0;)n.placeElm.append(angular.element(r.document.createElement("td")).addClass(n.$class.empty).addClass(n.$class.place))}else n.placeElm=angular.element(r.document.createElement("li")).addClass(n.$class.empty).addClass(n.$class.place);return t&&n.placeElm.css("height",_.height(t)+"px"),e?e[0].parentNode.insertBefore(n.placeElm[0],e[0]):n.getElementChilds().append(n.placeElm),n.placeElm},n.hidePlace=function(){n.placeElm&&n.placeElm.addClass(n.$class.hidden)},n.showPlace=function(){n.placeElm&&n.placeElm.removeClass(n.$class.hidden)},n.getScopeTree=function(){return n}),n.$safeApply=p,n.hiddenChild=function(e,t){var a=n.getScope(e);return a?t&&t.__expanded__&&t.__visible__?(a.$element.removeClass(n.$class.hidden),e.__visible__=!0):(a.$element.addClass(n.$class.hidden),e.__visible__=!1):t&&t.__expanded__&&t.__visible__?e.__visible__=!0:e.__visible__=!1,e.__expanded__===!1};var w,T,C,S,k,M,P,A,Y,O,X,N,I,j,F,H,K,L={showParent:!0,showChild:!1,beginAnd:!0},U=[["enableDrag",[["boolean","enableStatus",null,"enabledStatus"],["boolean","enableMove",null,"enabledMove"],["number","dragDelay",0,null,0],["boolean","enableCollapse",null,"enabledCollapse"],["boolean","enableHotkey",null,"enabledHotkey",null,function(e){e?n.enabledMove=!1:n.enabledMove=n.statusMove}]]],[["enableDrag","enableStatus"],[["string","templateCopy",a.templateCopy,"templateCopy",null,function(e){e&&o.get(e)&&d.setCopy(e,n)}],["string","templateMove",a.templateMove,"templateMove",null,function(e){e&&o.get(e)&&d.setMove(e,n)}]]],[[["enableDrag","enableDrop"]],[["number","dragBorder",30,"dragBorder",30]]],["*",[["boolean","treeTable",!0,"treeTable",null],["boolean","horizontal"],["callback","treeClass",function(e){switch(typeof e){case"string":n.$tree_class=e;break;case"object":angular.extend(n.$class,e),n.$tree_class=n.$class.tree;break;default:n.$tree_class=a.treeClass}},"treeClass",function(){n.$tree_class=n.$class.tree+" table"},null,function(){return/^(\s+[\w\-]+){2,}$/g.test(" "+a.treeClass)?(n.$tree_class=a.treeClass.trim(),!0):void 0}],[["object","string"],"expandOn",h,"expandingProperty",h,function(e){angular.isUndefinedOrNull(e)&&(n.expandingProperty=a.expandOn)}],["object","treeControl",angular.isDefined(n.tree)?n.tree:{},"tree",null,function(e){angular.isFunction(C)||(C=s("$TreeDnDControl")),angular.isFunction(C)&&(S=angular.extend(e,C(n)))}],[["array","object"],"columnDefs",m,"colDefinitions",m,function(e){!angular.isUndefinedOrNull(e)&&angular.isArray(e)||(n.colDefinitions=m())}],[["object","string","array","function"],"orderBy",a.orderBy],[["object","array"],"filter",null,"filter",null,function(e){var t=!1;if(angular.isDefined(e)&&!angular.isArray(e)){var a,r=Object.keys(e),l=r.length;if(l>0)for(a=0;l>a;a++)if("string"!=typeof e[r[a]]||0!==e[r[a]].length){t=!0;break}}n.enabledFilter=t,b()}],["object","filterOptions",L,"filterOptions",L,function(e){"object"==typeof e&&(n.filterOptions=angular.extend(L,e))}],["string","primaryKey",a.primaryKey,"primary_key","__uid__"],["string","indentUnit",a.indentUnit,"indent_unit"],["number","indent",30,null,30],["number","indentPlus",20,null,20],["null","callbacks",function(e){return angular.forEach(e,function(e,t){"function"==typeof e&&n.$callbacks[t]&&(n.$callbacks[t]=e)}),n.$callbacks},"$callbacks"],["number","expandLevel",3,"expandLevel",3,function(){b()}],["number","treeLimit",100,"$TreeLimit",100],["boolean","enableDrag",null,"dragEnabled"],["boolean","enableDrop",null,"dropEnabled"]]]],B=U.length;for(k=0;B>k;k++)if(u(a,U[k][0],!0))for(A=U[k][1],M=0,P=A.length;P>M;M++)Y=A[M][0],O=A[M][1],X=A[M][2],N=A[M][3],I=A[M][4],j=A[M][5],F=A[M][6],f(Y,O,X,N,I,j,F);a.treeData&&n.$watch(a.treeData,function(t){angular.equals(t,n.treeData)||(K=t,angular.isUndefinedOrNull(H)&&(H=e(c,350)))},!0),n.updateLimit=function(){n.$TreeLimit+=50},n.reload_data=b}function g(e){var i="",_=e.html().trim();return _.length>0&&(i=_,e.html("")),function(e,_,u){if(u.enableDrag){var g=s("$TreeDnDDrag");angular.isFunction(g)&&g(e,_,r,l)}_.ready(function(){function r(e,t){var r,l=e[0].querySelector("[tree-dnd-node]");if(t.isTable=null,l){if(l=angular.element(l),r=l.attr("ng-include")){var d=a(r)(t)||r;if("string"==typeof d)return n.get(d,{cache:o}).success(function(e){e=e.trim();var n=document.createElement("div");n.innerHTML=e,n=angular.element(n),t.isTable=!n[0].querySelector("[tree-dnd-nodes]")})}else t.isTable=!l[0].querySelector("[tree-dnd-nodes]");c.setTemplate(t,t.templateNode)}}var l;i.length>0?(l=r(angular.element(i.trim()),e),"object"==typeof l?l.then(function(){_.append(t(i)(e))}):_.append(t(i)(e))):n.get(u.templateUrl||d.getPath(),{cache:o}).success(function(n){n=angular.element(n.trim()),l=r(n,e),"object"==typeof l?l.then(function(){_.append(t(n)(e))}):_.append(t(n)(e))})})}}return{restrict:"E",scope:!0,replace:!0,controller:["$scope","$element","$attrs",u],compile:g}}function n(e,n,t,a,r){function l(){return g={width:x.prop("offsetWidth")||document.documentElement.clientWidth,height:x.prop("offsetHeight")||document.documentElement.clientHeight,top:n[0].body.scrollTop||n[0].documentElement.scrollTop,left:n[0].body.scrollLeft||n[0].documentElement.scrollLeft},v||$?void(b=!0):(v=!0,void o())}function o(){if(!$){var e,n=n>0?n:y.length;n>0?(e=y[0],$=!0,h=t(function(){y.splice(0,1),$=!1,n--,t.cancel(h),o()},0)):(v=!1,b&&(b=!1,l()))}}function d(e){m=e}function i(){return m}function _(){t.cancel(p),p=t(function(){l()},0)}function s(e,n){_(),y.push({element:n,scope:e})}function c(e,n){f=n}function u(){return y}var g,f,p,h,m=null,v=!1,$=!1,b=!1,y=[],D={setViewport:d,getViewport:i,add:s,setTemplate:c,getItems:u,updateDelayed:_},x=angular.element(e);return x.on("load resize scroll",_),D}function t(e){return angular.isUndefined(e)||null===e}function a(e){return!(angular.isUndefined(e)||null===e)}angular.isUndefinedOrNull=t,angular.isDefined=a,angular.module("ntt.TreeDnD",["template/TreeDnD/TreeDnD.html"]).constant("$TreeDnDClass",{tree:"tree-dnd",empty:"tree-dnd-empty",hidden:"tree-dnd-hidden",node:"tree-dnd-node",nodes:"tree-dnd-nodes",handle:"tree-dnd-handle",place:"tree-dnd-placeholder",drag:"tree-dnd-drag",status:"tree-dnd-status",icon:{1:"fa fa-fw fa-chevron-down",0:"fa fa-fw fa-chevron-right","-1":"fa fa-fw"}}),angular.module("ntt.TreeDnD").directive("compile",["$compile",function(e){return{restrict:"A",link:function(n,t,a){n.$watch(a.compile,function(a){a&&(angular.isFunction(t.empty)?t.empty():t.html(""),t.append(e(a)(n)))})}}}]).directive("compileReplace",["$compile",function(e){return{restrict:"A",link:function(n,t,a){n.$watch(a.compileReplace,function(a){a&&t.replaceWith(e(a)(n))})}}}]),angular.module("ntt.TreeDnD").directive("treeDndNodeHandle",function(){return{restrict:"A",scope:!0,link:function(e,n,t){n.data("$scope",e),e.$type="TreeDnDNodeHandle",e.$class.handle&&n.addClass(e.$class.handle)}}}),angular.module("ntt.TreeDnD").directive("treeDndNode",["$TreeDnDViewport","$timeout",function(e,n){function t(n,t,a){function r(e,n,a){var r,o=a[d];if(i)r=o.__icon__,o.__icon_class__=a.$class.icon[r];else{var _,s=o.__parent_real__,c=a.tree_nodes[s]||null,u=o.__children__,g=u.length;if(o.__inited__||(o.__inited__=!0),o.__hashKey__!==f&&(a.deleteScope(a,o),a.setScope(a,o),f=o.__hashKey__),!c||c.__expanded__&&c.__visible__?(t.removeClass(a.$class.hidden),o.__visible__=!0):(t.addClass(a.$class.hidden),o.__visible__=!1),0===g?(r=-1,o.__expanded__=!1):r=o.__expanded__?1:0,o.__icon__=r,o.__icon_class__=a.$class.icon[r],a.isTable)l||(l=a.getElementChilds()),o.__expanded__?l.removeClass(a.$class.hidden):l.addClass(a.$class.hidden);else for(_=0;g>_;_++)a.for_all_descendants(u[_],a.hiddenChild,o,!0)}i=!1}t.data("$scope",n),n.$node_class="",n.$class.node&&(t.addClass(n.$class.node),n.$node_class=n.$class.node);var l,o="boolean"==typeof n.dragEnabled||"boolean"==typeof n.dropEnabled,d=a.treeDndNode,i=!0;e.add(n,t),o&&(n.$type="TreeDnDNode",n.getData=function(){return n[d]}),n.$element=t,n[d].__inited__=!0,n.getElementChilds=function(){return angular.element(t[0].querySelector("[tree-dnd-nodes]"))},n.setScope(n,n[d]),n.getScopeNode=function(){return n};var _,s,c=[],u=Object.keys(n[d]),g=u.length,f=n[d].__hashKey__,p=["__visible__","__level__","__index__","__index_real__","__parent__","__parent_real__","__dept__","__icon__","__icon_class__"],h=["__expanded__"],m=h.length;for(s=0;g+m>s;s++)g>s?-1===p.indexOf(u[s])&&c.push(d+"."+u[s]):-1===u.indexOf(h[s-g])&&c.push(d+"."+h[s-g]);_="["+c.join(",")+"]",n.$watch(_,r,!0),n.$on("$destroy",function(){n.deleteScope(n,n[d])})}return{restrict:"A",replace:!0,link:t}}]),angular.module("ntt.TreeDnD").directive("treeDndNodes",function(){return{restrict:"A",replace:!0,link:function(e,n){e.$type="TreeDnDNodes",e.$class.nodes?(n.addClass(e.$class.nodes),e.$nodes_class=e.$class.nodes):e.$nodes_class=""}}}),angular.module("ntt.TreeDnD").directive("treeDnd",e),e.$inject=["$timeout","$http","$compile","$parse","$window","$document","$templateCache","$TreeDnDTemplate","$TreeDnDClass","$TreeDnDHelper","$TreeDnDPlugin","$TreeDnDViewport"],angular.module("ntt.TreeDnD").factory("$TreeDnDConvert",function(){var e={line2tree:function(e,n,t,a){if(a="function"==typeof a?a:function(){},!e||0===e.length||!n||!t)return[];for(var r,l,o=[],d=[],i=e[0],_=i[n],s={},c=e.length,u=0;c>u;)i=e[u++],a(i),_=i[n],s[_]=i;for(u=0;c>u;)i=e[u++],a(i),_=i[n],s[_]=i,r=i[t],r?(l=s[r],l&&(l.__children__?l.__children__.push(i):l.__children__=[i])):d.push(_);for(c=d.length,u=0;c>u;u++)o.push(s[d[u]]);return o},tree2tree:function n(e,t,a){a="function"==typeof a?a:function(){};var r,l,o,d=[],i=e?e.length:0;for(r=0;i>r;r++)l=angular.copy(e[r]),a(l),angular.isArray(l[t])&&l[t].length>0&&(o=n(l[t],t,a),delete l[t],l.__children__=o),d.push(l);return d}};return e}),angular.module("ntt.TreeDnD").factory("$TreeDnDHelper",["$document","$window",function(e,n){var t={nodrag:function(e){return"undefined"!=typeof e.attr("data-nodrag")},eventObj:function(e){var n=e;return void 0!==e.targetTouches?n=e.targetTouches.item(0):void 0!==e.originalEvent&&void 0!==e.originalEvent.targetTouches&&(n=e.originalEvent.targetTouches.item(0)),n},dragInfo:function(e){var n=e.getData(),t=e.getScopeTree(),a=e.getNode(n.__parent_real__);return{node:n,nodes:t.tree.get_selected_nodes(),parent:a,move:{parent:a,pos:n.__index__},scope:e,target:t,drag:t,drop:e.getPrevSibling(n),changed:!1}},height:function(e){return e.prop("scrollHeight")},width:function(e){return e.prop("scrollWidth")},offset:function(t){var a=t[0].getBoundingClientRect();return{width:t.prop("offsetWidth"),height:t.prop("offsetHeight"),top:a.top+(n.pageYOffset||e[0].body.scrollTop||e[0].documentElement.scrollTop),left:a.left+(n.pageXOffset||e[0].body.scrollLeft||e[0].documentElement.scrollLeft)}},positionStarted:function(e,n){var t={};return t.offsetX=e.pageX-this.offset(n).left,t.offsetY=e.pageY-this.offset(n).top,t.startX=t.lastX=e.pageX,t.startY=t.lastY=e.pageY,t.nowX=t.nowY=t.distX=t.distY=t.dirAx=0,t.dirX=t.dirY=t.lastDirX=t.lastDirY=t.distAxX=t.distAxY=0,t},positionMoved:function(e,n,t){n.lastX=n.nowX,n.lastY=n.nowY,n.nowX=e.pageX,n.nowY=e.pageY,n.distX=n.nowX-n.lastX,n.distY=n.nowY-n.lastY,n.lastDirX=n.dirX,n.lastDirY=n.dirY,n.dirX=0===n.distX?0:n.distX>0?1:-1,n.dirY=0===n.distY?0:n.distY>0?1:-1;var a=Math.abs(n.distX)>Math.abs(n.distY)?1:0;return t?(n.dirAx=a,void(n.moving=!0)):(n.dirAx!==a?(n.distAxX=0,n.distAxY=0):(n.distAxX+=Math.abs(n.distX),0!==n.dirX&&n.dirX!==n.lastDirX&&(n.distAxX=0),n.distAxY+=Math.abs(n.distY),0!==n.dirY&&n.dirY!==n.lastDirY&&(n.distAxY=0)),void(n.dirAx=a))},replaceIndent:function(e,n,t,a){a=a||"left",angular.element(n.children()[0]).css(a,e.$callbacks.calsIndent(t))}};return t}]),angular.module("ntt.TreeDnD").factory("$TreeDnDPlugin",["$injector",function(e){var n=function(n){return angular.isDefined(e)&&e.has(n)?e.get(n):null};return n}]),angular.module("ntt.TreeDnD").factory("$TreeDnDTemplate",["$templateCache",function(e){var n,t="template/TreeDnD/TreeDnD.html",a="template/TreeDnD/TreeDnDStatusCopy.html",r="template/TreeDnD/TreeDnDStatusMove.html",l={},o={setMove:function(e,n){l[n.$id]||(l[n.$id]={}),l[n.$id].movePath=e},setCopy:function(e,n){l[n.$id]||(l[n.$id]={}),l[n.$id].copyPath=e},getPath:function(){return t},getCopy:function(t){return l[t.$id]&&l[t.$id].copyPath&&(n=e.get(l[t.$id].copyPath))?n:e.get(a)},getMove:function(t){return l[t.$id]&&l[t.$id].movePath&&(n=e.get(l[t.$id].movePath))?n:e.get(r)}};return o}]),angular.module("ntt.TreeDnD").factory("$TreeDnDViewport",n),n.$inject=["$window","$document","$timeout","$q","$compile"],angular.module("ntt.TreeDnD").factory("$TreeDnDFilter",["$filter",function(e){function n(e,t,a,r,l,o){if(!angular.isFunction(r))return null;var d,i,_,s=r(e,t),c=!1,u=e.filter_index;if(angular.isDefined(t[a])){for(_=t[a],i=_.length,e.filter_index=0,d=0;i>d;d++)c=n(e,_[d],a,r,l,s||o)||c;e.filter_index=u}return angular.isFunction(l)&&l(e,t,s===!0,c===!0,o===!0),s||c}function t(n,t){if(angular.isUndefinedOrNull(t)||angular.isArray(t))return null;if(angular.isFunction(n))return n(t,e);if("boolean"==typeof n)return t=!!t,t===n;if(!angular.isDefined(n))return null;try{var a=new RegExp(n);return a.test(t)}catch(r){return"string"==typeof t?t.indexOf(n)>-1:null}}function a(e,n,a){if(angular.isArray(n))return r(e,n,a);var l,o,d,i=n.field,_=n.callback;if("_$"===i){for(o=Object.keys(e),d=o.length,l=0;d>l;l++)if(t(_,e[o[l]]))return!0}else if(angular.isDefined(e[i]))return t(_,e[i]);return null}function r(e,n,t){var r,l=n.length||0,o=!1;if(0===l)return null;for(r=0;l>r;r++)if(a(e,n[r],!t)){if(o=!0,!t)return!0}else if(t)return!1;return o}function l(e,n,t,a,r){return t===!0?(n.__filtered__=!0,n.__filtered_visible__=!0,void(n.__filtered_index__=e.filter_index++)):a===!0&&e.showParent===!0||r===!0&&e.showChild===!0?(n.__filtered__=!1,n.__filtered_visible__=!0,void(n.__filtered_index__=e.filter_index++)):(delete n.__filtered__,delete n.__filtered_visible__,void delete n.__filtered_index__)}function o(e,n){return 0===e.filter.length?!0:a(n,e.filter,e.beginAnd||!1)}function d(e,n){return!1}function i(e){var n,t,a,r,l;if(angular.isObject(e)&&!angular.isArray(e)){if(a=Object.keys(e),t=a.length,r=[],t>0)for(n=0;t>n;n++)"string"==typeof e[a[n]]&&0===e[a[n]].length||(l=angular.isArray(e[a[n]])?e[a[n]]:angular.isObject(e[a[n]])?i(e[a[n]]):{field:a[n],callback:e[a[n]]},r.push(l));return l=null,r}return e}function _(e,t,a,r){if(!angular.isArray(e)||0===e.length)return e;var _,s,c;if(c=i(t),!angular.isArray(c)&&!angular.isObject(c)||0===c.length){for(_=0,s=e.length;s>_;_++)n(a,e[_],r||"__children__",d,l);return e}for(a.filter=c,a.filter_index=0,_=0,s=e.length;s>_;_++)n(a,e[_],r||"__children__",o,l);return e}return _}]),angular.module("ntt.TreeDnD").factory("$TreeDnDOrderBy",["$filter",function(e){var n=e("orderBy"),t=function l(e,n,t,a){var r,o,d;if(angular.isDefined(n[t])){for(d=n[t],o=d.length,r=0;o>r;r++)d[r]=l(e,d[r],t,a);n[t]=a(n[t],e)}return n},a=function(e,t){return n(e,t)},r=function(e,n){if(!angular.isArray(e)||0===e.length||!(angular.isArray(n)||angular.isObject(n)||angular.isString(n)||angular.isFunction(n))||0===n.length&&!angular.isFunction(n))return e;var r,l;for(r=0,l=e.length;l>r;r++)e[r]=t(n,e[r],"__children__",a);return a(e,n)};return r}]),angular.module("ntt.TreeDnD").factory("$TreeDnDDrag",["$timeout","$TreeDnDHelper",function(e,n){function t(e,t){if(t.placeElm){var a=n.offset(t.placeElm);if(a.top<=e.pageY&&e.pageY<=a.top+a.height&&a.left<=e.pageX&&e.pageX<=a.left+a.width)return!0}return!1}function a(e,t){if((t.hasTouch||2!==e.button&&3!==e.which&&!e.metaKey&&!e.shiftKey)&&!(e.uiTreeDragging||e.originalEvent&&e.originalEvent.uiTreeDragging)){var a=angular.element(e.target),r=a.scope();if(r&&r.$type&&"TreeDnDNodeHandle"===r.$type){var l,o=a.prop("tagName").toLowerCase(),d=t.$scope;if("input"!==o&&"textarea"!==o&&"button"!==o&&"select"!==o){for(;a&&a[0]&&a[0]!==t.element;){if(n.nodrag(a))return;a=a.parent()}if(e.uiTreeDragging=!0,e.originalEvent&&(e.originalEvent.uiTreeDragging=!0),e.preventDefault(),l=r.getScopeNode(),t.firstMoving=!0,d.$callbacks.beforeDrag(l)){var i=n.eventObj(e),_=l.$element.prop("tagName").toLowerCase(),s="tr"===_;t.dragInfo=n.dragInfo(l),d.setDragging(t.dragInfo),t.pos=n.positionStarted(i,l.$element),s?t.dragElm=angular.element(t.$window.document.createElement("table")).addClass(d.$class.tree).addClass(d.$class.drag).addClass(d.$tree_class):t.dragElm=angular.element(t.$window.document.createElement("ul")).addClass(d.$class.hidden).addClass("tree-dnd-nodes").addClass(d.$tree_class),t.dragElm.css({width:n.width(l.$element)+"px","z-index":9995}),t.offsetEdge=0;var c=n.width(l.$element),u=l,g=u.$element,f=null,p=!!d.enabledCollapse,h=!1,m=null;if(s)t.offsetEdge=t.dragInfo.node.__level__-1,m=angular.element(t.$window.document.createElement("tbody")),d.for_all_descendants(t.dragInfo.node,function(e){u=d.getScope(e),g=u.$element,h||(f=g.clone(),n.replaceIndent(u,f,e.__level__-t.offsetEdge,"padding-left"),m.append(f),p&&(h=!0)),d.enabledMove&&d.$class.hidden&&g.addClass(d.$class.hidden)}),t.dragElm.append(m);else{if(p){var v=u.getElementChilds(),$=angular.element("<swaped />");v.after(angular.element("<holder />")),$.append(v),f=g.clone(),f.find("holder").remove(),g.find("holder").replaceWith(v),$.remove(),v=null}else f=g.clone();t.dragElm.append(f),d.enabledMove&&d.$class.hien&&g.addClass(d.$class.hidden)}t.dragElm.css({left:i.pageX-t.pos.offsetX+d.$callbacks.calsIndent(t.offsetEdge+1,!0,!0)+"px",top:i.pageY-t.pos.offsetY+"px"}),t.$document.find("body").append(t.dragElm),d.$callbacks.droppable()&&(t.placeElm=d.initPlace(l.$element,t.dragElm),s&&n.replaceIndent(d,t.placeElm,t.dragInfo.node.__level__),t.placeElm.css("width",c)),d.hidePlace(),d.targeting=!0,d.enabledStatus&&(d.refreshStatus(),d.setPositionStatus(e)),angular.element(t.$document).bind("touchend",t.dragEndEvent),angular.element(t.$document).bind("touchcancel",t.dragEndEvent),angular.element(t.$document).bind("touchmove",t.dragMoveEvent),angular.element(t.$document).bind("mouseup",t.dragEndEvent),angular.element(t.$document).bind("mousemove",t.dragMoveEvent),angular.element(t.$document).bind("mouseleave",t.dragCancelEvent),t.document_height=Math.max(t.body.scrollHeight,t.body.offsetHeight,t.html.clientHeight,t.html.scrollHeight,t.html.offsetHeight),t.document_width=Math.max(t.body.scrollWidth,t.body.offsetWidth,t.html.clientWidth,t.html.scrollWidth,t.html.offsetWidth)}}}}}function r(e,a){var r=a.$scope;if(!a.dragStarted)return void(a.dragDelaying||(a.dragStarted=!0,r.$safeApply(function(){r.$callbacks.dragStart(a.dragInfo)})));if(a.dragElm){e.preventDefault(),a.$window.getSelection?a.$window.getSelection().removeAllRanges():a.$window.document.selection&&a.$window.document.selection.empty();var l=n.eventObj(e),o=l.pageX-a.pos.offsetX,d=l.pageY-a.pos.offsetY;0>o&&(o=0),0>d&&(d=0),d+10>a.document_height&&(d=a.document_height-10),o+10>a.document_width&&(o=a.document_width-10),a.dragElm.css({left:o+r.$callbacks.calsIndent(a.offsetEdge+1,!0,!0)+"px",top:d+"px"}),r.enabledStatus&&r.setPositionStatus(e);var i=window.pageYOffset||a.$window.document.documentElement.scrollTop,_=i+(window.innerHeight||a.$window.document.clientHeight||a.$window.document.clientHeight);if(_<l.pageY&&_<=a.document_height&&window.scrollBy(0,10),i>l.pageY&&window.scrollBy(0,-10),n.positionMoved(e,a.pos,a.firstMoving),a.firstMoving)return void(a.firstMoving=!1);var s,c,u,g,f,p,h,m,v,$,b,y,D,x=l.pageX-a.$window.document.body.scrollLeft,E=l.pageY-(window.pageYOffset||a.$window.document.documentElement.scrollTop),w=!0,T=!0,C=a.dragInfo,S=C.move,k=C.node,M=C.drop,P=C.target,A=t(e,a);if(!A){if(s=angular.element(a.$window.document.elementFromPoint(x,E)),c=s.scope(),!c)return;if(D=function(){if(P=c.getScopeTree(),b=C.target,C.target!==P){if(!P.$callbacks.droppable())return!1;b.hidePlace(),b.targeting=!1,P.targeting=!0,C.target=P,a.placeElm=P.initPlace(c.$element,a.dragElm),b=null,v=!0}return!0},angular.isFunction(c.getScopeNode)){if(c=c.getScopeNode(),!D())return}else{if("TreeDnDNodes"!==c.$type&&"TreeDnD"!==c.$type)return;if(!c.tree_nodes)return;if(0===c.tree_nodes.length){if(!D())return;m=!0}}}if((a.pos.dirAx&&!v||A)&&(T=!1,c=C.scope),!c.$element&&!c)return;if(p=c.$element.prop("tagName").toLowerCase(),h="tbody"===p||"table"===p||"tr"===p||"td"===p,m)S.parent=null,S.pos=0,M=null;else if(T){if(s=c.$element,f=n.offset(s),c.horizontal&&!h)u=l.pageX<f.left+n.width(s)/2;else if(h)u=l.pageY<f.top+n.height(s)/2;else{var Y=n.height(s);if(c.getElementChilds()&&(Y-=n.height(c.getElementChilds())),l.pageY>f.top+Y)return;u=l.pageY<f.top+.5*Y,g=l.pageY>f.top+.25*Y&&l.pageY<f.top+.75*Y}if(!angular.isFunction(c.getData))return;if(b=c.getData(),y=c.getNode(b.__parent_real__),b.groupId&&g)S.parent=b,S.pos=0,M=null;else if(u){var O=c.getPrevSibling(b);S.parent=y,S.pos=angular.isDefined(O)?O.__index__+1:0,M=O}else!b.__expanded__||1===b.__children__.length&&b.__index_real__===k.__parent_real__?(S.parent=y,S.pos=b.__index__+1,M=b):(S.parent=b,S.pos=0,M=null)}else{if(!(a.pos.dirAx&&a.pos.distAxX>=P.dragBorder))return;if(a.pos.distAxX=0,a.pos.distX>0){if(y=M,!y){if(!(S.pos-1>=0))return;y=S.parent.__children__[S.pos-1]}if(C.drag===C.target&&y===k&&r.enabledMove&&(y=P.getPrevSibling(y)),!y||!y.__visible__)return;var X=y.__children__.length;S.parent=y,S.pos=X,M=X>0?y.__children__[X-1]:null}else{if(!(a.pos.distX<0))return;if(b=S.parent,!b||!(0===b.__children__.length||b.__children__.length-1<S.pos||C.drag===C.target&&b.__index_real__===k.__parent_real__&&b.__children__.length-1===k.__index__&&r.enabledMove))return;y=P.getNode(b.__parent_real__),S.parent=y,S.pos=b.__index__+1,M=b}}if(C.drag===C.target&&S.parent&&k.__parent_real__===S.parent.__index_real__&&k.__index__===S.pos&&(w=!1),P.$callbacks.accept(C,S,w)){if(C.move=S,C.drop=M,C.changed=w,C.scope=c,h)n.replaceIndent(P,a.placeElm,angular.isUndefinedOrNull(S.parent)?1:S.parent.__level__+1),M?(y=(S.parent?S.parent.__children__:null)||C.target.treeData,M.__index__<y.length-1?(M=y[M.__index__],$=C.target.getScope(M),$.$element[0].parentNode.insertBefore(a.placeElm[0],$.$element[0])):(b=C.target.getLastDescendant(M),$=C.target.getScope(b),$.$element.after(a.placeElm))):($=C.target.getScope(S.parent),$&&(S.parent?$.$element.after(a.placeElm):$.getElementChilds().prepend(a.placeElm)));else{$=C.target.getScope(M||S.parent),a.lastParent&&a.lastParent.removeClass("tree-dnd-dragover");var N=!0;M?$.$element.after(a.placeElm):S.parent?(a.lastParent=$.$element,S.parent.__expanded__?$.getElementChilds().prepend(a.placeElm):($.$element.addClass("tree-dnd-dragover"),N=!1)):$.getElementChilds().prepend(a.placeElm)}N?P.showPlace():P.hidePlace(),r.$safeApply(function(){r.$callbacks.dragMove(C)})}}}function l(e,n){if(e.preventDefault(),n.dragElm){var t=!1,a=n.$scope,r=a.getScope(n.dragInfo.node),l=r.$element.prop("tagName").toLowerCase(),o="tr"===l,i=r.$element;a.$safeApply(function(){t=a.$callbacks.beforeDrop(n.dragInfo)}),o?a.for_all_descendants(n.dragInfo.node,function(e){r=a.getScope(e),i=r.$element,r.$class.hidden&&i.removeClass(a.$class.hidden)}):a.$class.hidden&&i.removeClass(a.$class.hidden),n.dragElm.remove(),n.dragElm=null,n.lastParent&&n.lastParent.removeClass("tree-dnd-dragover"),a.enabledStatus&&a.hideStatus();var _=!1;a.$$apply?a.$safeApply(function(){_=a.$callbacks.dropped(n.dragInfo,t,a.enabledMove)}):d(n),a.$safeApply(function(){a.$callbacks.dragStop(n.dragInfo,_)}),n.dragInfo.target.hidePlace(),n.dragInfo.target.targeting=!1,n.dragInfo=null,a.$$apply=!1,a.setDragging(null)}angular.element(n.$document).unbind("touchend",n.dragEndEvent),angular.element(n.$document).unbind("touchcancel",n.dragEndEvent),angular.element(n.$document).unbind("touchmove",n.dragMoveEvent),angular.element(n.$document).unbind("mouseup",n.dragEndEvent),angular.element(n.$document).unbind("mousemove",n.dragMoveEvent),angular.element(n.$window.document.body).unbind("mouseleave",n.dragCancelEvent)}function o(e,n){n.$scope.$callbacks.draggable()&&a(e,n)}function d(n){n.element.bind("touchstart mousedown",function(t){o(t,n),n.dragDelaying=!0,n.dragStarted=!1,n.dragTimer=e(function(){
n.dragDelaying=!1},n.$scope.dragDelay)}),n.element.bind("touchend touchcancel mouseup",function(){e.cancel(n.dragTimer)})}function i(e,n){var t=n.$scope;if(27===e.keyCode)t.enabledStatus&&t.hideStatus(),t.$$apply=!1,l(e,n);else if(t.enabledHotkey&&e.shiftKey){if(t.enableMove(!0),t.enabledStatus&&t.refreshStatus(),!n.dragInfo)return;var a=t.getScope(n.dragInfo.node),r=a.$element;a.isTable?t.for_all_descendants(n.dragInfo.node,function(e,n){return a=t.getScope(e),r=a&&a.$element,a&&r&&(!n&&e.__visible__||n.__expanded__)&&t.$class.hidden&&r.addClass(t.$class.hidden),e.__visible__===!1||e.__expanded__===!1},null,!0):t.$class.hidden&&r.addClass(t.$class.hidden)}}function _(e,n){var t=n.$scope;if(t.enabledHotkey&&!e.shiftKey){if(t.enableMove(!1),t.enabledStatus&&t.refreshStatus(),!n.dragInfo)return;var a=t.getScope(n.dragInfo.node),r=a.$element;a.isTable?t.for_all_descendants(n.dragInfo.node,function(e,n){return a=t.getScope(e),r=a&&a.$element,a&&r&&(!n&&e.__visible__||n.__expanded__)&&t.$class.hidden&&r.removeClass(t.$class.hidden),e.__visible__===!1||e.__expanded__===!1},null,!0):t.$class.hidden&&r.removeClass(t.$class.hidden)}}function s(e,n,t,a){var o={hasTouch:"ontouchstart"in window,firstMoving:null,dragInfo:null,pos:null,placeElm:null,dragElm:null,dragDelaying:!0,dragStarted:!1,dragTimer:null,body:document.body,html:document.documentElement,document_height:null,document_width:null,offsetEdge:null,$scope:e,$window:t,$document:a,element:n,bindDrag:function(){d(o)},dragEnd:function(e){l(e,o)},dragMoveEvent:function(e){r(e,o)},dragEndEvent:function(n){e.$$apply=!0,l(n,o)},dragCancelEvent:function(e){l(e,o)}},s=function(e){return i(e,o)},c=function(e){return _(e,o)};e.dragEnd=function(e){o.dragEnd(e)},o.bindDrag(),angular.element(t.document.body).bind("keydown",s),angular.element(t.document.body).bind("keyup",c),e.$on("$destroy",function(){angular.element(t.document.body).unbind("keydown",s),angular.element(t.document.body).unbind("keyup",c),e.statusElm&&e.statusElm.remove(),e.placeElm&&e.placeElm.remove()})}return s}]),angular.module("ntt.TreeDnD").factory("$TreeDnDControl",function(){function e(e){e.__expanded__=!1}function n(e){e.__expanded__=!0}function t(e){e.__selected__=!1}function a(a){var _,s={anchor_node:null,selected_nodes:[],for_all_descendants:a.for_all_descendants,select_anchor_node:function(e){return e?(e&&(s.deselect_all(),s.select_node(e),s.anchor_node=e,s.expand_all_parents(e)),e):null},select_node:function(e){return!e||s.is_selected(e)?null:(e.__selected__=!0,s.selected_nodes.push(e),e)},is_selected:function(e){return e.__selected__===!0},add_select_node:function(e){return e?s.is_selected(e)?(s.deselect_node(e),null):(s.select_node(e),s.deselect_descendants(e),s.process_selection(),e):null},range_select_node:function(e){if(!e)return null;if(!s.anchor_node)return s.select_anchor_node(e);for(angular.forEach(s.selected_nodes,t),s.selected_nodes=[],s.select_node(s.anchor_node);e&&e!==s.anchor_node;)s.select_node(e),e=e.__index_real__<s.anchor_node.__index_real__?s.get_next_node(e):s.get_prev_node(e);return s.process_selection(),s.selected_nodes},deselect_node:function(e,n){r=null,e!==s.anchor_node||n||(r=s.anchor_node,s.anchor_node=null);var a=s.is_selected(e),l=s.selected_nodes.indexOf(e);return a&&(t(e),s.selected_nodes.splice(l,1),r=e),r},deselect_descendants:function(e){e=e||s.anchor_node,e&&(o=s.get_children(e),o.length>0&&o.forEach(function(e){s.deselect_descendants(e),s.deselect_node(e,!0)}))},deselect_all:function(){s.anchor_node&&(s.anchor_node=null),s.selected_nodes&&(s.selected_nodes.forEach(t),s.selected_nodes=[])},process_selection:function(e){function n(e){var t=s.get_children(e),a=0,r=0;if(t.length){for(var l=0;l<t.length;l++)r+=n(t[l]),s.is_selected(t[l])&&++a;a===t.length?(s.select_node(e),s.deselect_descendants(e)):(a||r)&&s.deselect_node(e,!0)}return r+a}e=e||s.selected_nodes,e.sort(function(e,n){return e.__index_real__-n.__index_real__}),e.forEach(n)},get_parent:function(e){return e&&null!==e.__parent_real__?a.tree_nodes[e.__parent_real__]:null},for_all_ancestors:function(e,n){return l=s.get_parent(e),l?n(l)?!1:s.for_all_ancestors(l,n):!0},expand_all_parents:function(e){return s.for_all_ancestors(e,n)},reload_data:function(){return a.reload_data()},ungroup_node:function(e){if(e=e||s.anchor_node,e&&e.__children__.length>0){var n=s.get_parent(e),t=e.__index__,a=e.__children__;s.deselect_all(),s.remove_node(e),s.add_nodes(n,a,t,!0),s.reload_data()}},group_selected_nodes:function(){if(s.selected_nodes.length){var e={nodeId:"Group",groupId:"NewGroup",__children__:[]},n=s.selected_nodes,t=n[0].__index__,a=s.get_parent(n[0]);return e.__children__=n,s.remove_nodes(n,!0),s.add_node(a,e,t||0,!1),e.__expanded__=!1,s.select_anchor_node(e),s.reload_data(),e}return null},add_node:function(e,n,t,r){return"number"!=typeof t?e?(e.__children__.push(n),e.__expanded__=!0):a.treeData.push(n):e?(e.__children__.splice(t,0,n),e.__expanded__=!0):a.treeData.splice(t,0,n),r&&s.select_node(n),n},add_nodes:function(e,n,t,a){n.forEach(function(n,r){s.add_node(e,n,t+r,a)})},add_node_root:function(e){return s.add_node(null,e),e},expand_all:function(){for(i=a.treeData.length,d=0;i>d;d++)s.for_all_descendants(a.treeData[d],n)},collapse_all:function(){for(i=a.treeData.length,d=0;i>d;d++)s.for_all_descendants(a.treeData[d],e)},remove_node:function(e){e=e||s.anchor_node,e&&(l=null!==e.__parent_real__?s.get_parent(e).__children__:a.treeData,s.anchor_node===e&&(s.anchor_node=null),l.splice(e.__index__,1))},remove_nodes:function(e,n){return e=e||s.selected_nodes,e=e.slice().sort(function(e,n){return n.__index_real__-e.__index_real__}),e&&angular.forEach(e,s.remove_node),n||s.reload_data(),e},expand_node:function(e){return e=e||s.anchor_node,e?(e.__expanded__=!0,e):void 0},collapse_node:function(e){return e=e||s.anchor_node,e?(e.__expanded__=!1,e):void 0},get_anchor_node:function(){return s.anchor_node},get_selected_nodes:function(){return s.selected_nodes},get_first_node:function(){return i=a.treeData.length,i>0?a.treeData[0]:null},get_children:function(e){return e.__children__},get_siblings:function(e){return e=e||s.anchor_node,e?(l=s.get_parent(e),r=l?l.__children__:a.treeData):void 0},get_next_sibling:function(e){return e=e||s.anchor_node,e&&(r=s.get_siblings(e),_=r.length,e.__index__<_)?r[e.__index__+1]:void 0},get_prev_sibling:function(e){return e=e||s.anchor_node,r=s.get_siblings(e),e.__index__>0?r[e.__index__-1]:void 0},get_first_child:function(e){return e=e||s.anchor_node,e&&(r=e.__children__,r&&r.length>0)?e.__children__[0]:null},get_closest_ancestor_next_sibling:function(e){return e=e||s.anchor_node,(r=s.get_next_sibling(e))?r:(l=s.get_parent(e),s.get_closest_ancestor_next_sibling(l))},get_next_node:function(e){return e=e||s.anchor_node,e?(r=s.get_first_child(e),r?r:s.get_closest_ancestor_next_sibling(e)):void 0},get_prev_node:function(e){return e=e||s.anchor_node,e?(r=s.get_prev_sibling(e))?s.get_last_descendant(r):l=s.get_parent(e):void 0},get_last_descendant:a.getLastDescendant,select_parent_node:function(e){return e=e||s.anchor_node,e&&(l=s.get_parent(e))?s.select_node(l):void 0},select_first_node:function(){return s.select_node(s.get_first_node())},select_next_sibling:function(e){return e=e||s.anchor_node,e&&(r=s.get_next_sibling(e))?s.select_node(r):void 0},select_prev_sibling:function(e){return e=e||s.anchor_node,e&&(r=s.get_prev_sibling(e))?s.select_node(r):void 0},select_next_node:function(e){return e=e||s.anchor_node,e&&(r=s.get_next_node(e))?s.select_node(r):void 0},select_prev_node:function(e){return e=e||s.anchor_node,e&&(r=s.get_prev_node(e))?s.select_node(r):void 0}};return angular.extend(a.tree,s),a.tree}var r,l,o,d,i;return a}),angular.module("template/TreeDnD/TreeDnD.html",[]).run(["$templateCache",function(e){e.put("template/TreeDnD/TreeDnD.html",['<table ng-class="$tree_class">',"    <thead>","  <tr>",'     <th ng-class="expandingProperty.titleClass" ng-style="expandingProperty.titleStyle">',"         {{expandingProperty.displayName || expandingProperty.field || expandingProperty}}","        </th>",'        <th ng-repeat="col in colDefinitions" ng-class="col.titleClass" ng-style="col.titleStyle">',"         {{col.displayName || col.field}}","     </th>","    </tr>","    </thead>"," <tbody tree-dnd-nodes>",'  <tr tree-dnd-node="node" ng-repeat="node in tree_nodes track by node.__hashKey__" ','       ng-if="(node.__inited__ || node.__visible__)"','       ng-click="onSelect(node)" ',"       ng-class=\"(node.__selected__ ? ' active':'')\">","        <td tree-dnd-node-handle","          ng-style=\"expandingProperty.cellStyle ? expandingProperty.cellStyle : {'padding-left': $callbacks.calsIndent(node.__level__)}\"",'          ng-class="expandingProperty.cellClass"','          compile="expandingProperty.cellTemplate">',"              <a data-nodrag>",'                  <i ng-class="node.__icon_class__" ng-click="toggleExpand(node)"','                     class="tree-icon"></i>',"              </a>","             {{node[expandingProperty.field] || node[expandingProperty]}}","        </td>",'        <td ng-repeat="col in colDefinitions" ng-class="col.cellClass" ng-style="col.cellStyle"','            compile="col.cellTemplate">',"            {{node[col.field]}}","        </td>","    </tr>","    </tbody>","</table>"].join("\n")),e.put("template/TreeDnD/TreeDnDStatusCopy.html",'<label><i class="fa fa-copy"></i>&nbsp;<b>Copying</b></label>'),e.put("template/TreeDnD/TreeDnDStatusMove.html",'<label><i class="fa fa-file-text"></i>&nbsp;<b>Moving</b></label>')}])}();
//# sourceMappingURL=ng-tree-dnd.min.js.map
